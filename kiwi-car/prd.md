# KiwiCar 产品需求文档 (PRD)

**文档版本:** 1.0
**创建日期:** 2024年1月
**产品名称:** KiwiCar
**文档状态:** 草案

---

## 目录

1. [产品概述](#1-产品概述)
2. [目标用户](#2-目标用户)
3. [核心功能需求](#3-核心功能需求)
4. [用户故事](#4-用户故事)
5. [信息架构](#5-信息架构)
6. [功能优先级](#6-功能优先级)
7. [技术栈](#7-技术栈)
8. [非功能性需求](#8-非功能性需求)
9. [数据需求](#9-数据需求)
10. [第三方集成](#10-第三方集成)
11. [风险与约束](#11-风险与约束)
12. [成功指标](#12-成功指标)
13. [附录](#13-附录)

---

## 1. 产品概述

### 1.1 产品愿景

KiwiCar 致力于成为新西兰最受信赖的二手车交易平台，通过AI技术和官方数据集成，让每一次二手车交易都安全、透明、高效。

### 1.2 产品定位

面向新西兰本地用户的C2C二手车交易平台，主打：
- **安全性:** 基于NZTA官方数据的车辆历史查询
- **透明性:** AI智能定价，消除信息不对称
- **高效性:** AI辅助发布，30秒完成车辆上架

### 1.3 市场背景

- 新西兰二手车市场规模约$10B NZD/年
- 现有平台（TradeMe, Facebook Marketplace）缺乏专业车辆分析功能
- 用户痛点：难以判断车况真实性、不知道合理价格、发布流程繁琐

### 1.4 竞品分析

| 功能 | TradeMe | FB Marketplace | KiwiCar |
|------|---------|----------------|---------|
| 车牌查车况 | ❌ | ❌ | ✅ |
| AI智能定价 | ❌ | ❌ | ✅ |
| AI生成描述 | ❌ | ❌ | ✅ |
| 降价提醒 | ❌ | ❌ | ✅ |
| 信任度 | 高 | 中 | 待建立 |
| 费用 | 收费 | 免费 | 免费/Freemium |

---

## 2. 目标用户

### 2.1 用户画像

#### 买家 (Buyer)

| 属性 | 描述 |
|------|------|
| 年龄 | 25-55岁 |
| 身份 | 新西兰居民、PR、新移民 |
| 需求 | 寻找性价比高的可靠二手车 |
| 痛点 | 担心买到事故车/翻新车、不知道合理价格 |
| 行为 | 会在多个平台比价、重视车辆历史 |
| 设备 | 70% Mobile, 30% Desktop |

**典型场景:**
- 新移民刚到NZ，需要快速购买代步车
- 家庭用户升级换车，预算有限
- 年轻人购买第一辆车

#### 卖家 (Seller)

| 属性 | 描述 |
|------|------|
| 年龄 | 25-60岁 |
| 身份 | 需要卖车的个人车主 |
| 需求 | 快速、省心地卖出爱车，获得合理价格 |
| 痛点 | 不知道定多少钱、写车况描述费时 |
| 行为 | 希望尽快成交、不想处理太多询问 |
| 设备 | 60% Mobile, 40% Desktop |

**典型场景:**
- 准备离开新西兰，需要快速出手
- 换新车，旧车需要处理
- 车辆闲置，希望变现

### 2.2 用户旅程地图

#### 买家旅程

```
发现需求 → 搜索车源 → 筛选对比 → 查询车况 → 收藏关注 → 联系卖家 → 看车验车 → 完成交易
    ↓          ↓          ↓          ↓          ↓          ↓
  Landing    列表页    详情页    车牌查询   收藏夹    站内信/电话
```

#### 卖家旅程

```
决定卖车 → 注册登录 → 输入车牌 → 上传照片 → AI生成描述 → 设定价格 → 发布上架 → 响应询问 → 完成交易
    ↓          ↓          ↓          ↓           ↓          ↓          ↓
  Landing    注册页    发布流程   发布流程     AI服务    AI定价建议   车源管理
```

---

## 3. 核心功能需求

### 3.1 用户系统 (User System)

#### 3.1.1 注册

**功能描述:** 用户可通过手机号或邮箱创建账户

**需求详情:**

| ID | 需求 | 优先级 |
|----|------|--------|
| U-001 | 支持NZ手机号（+64）注册 | P0 |
| U-002 | 支持Email注册 | P0 |
| U-003 | 手机号验证码验证（SMS） | P0 |
| U-004 | Email验证链接验证 | P0 |
| U-005 | 密码强度校验（最少8位，含字母和数字） | P0 |
| U-006 | 社交账号登录（Google, Facebook） | P1 |
| U-007 | Apple ID登录 | P2 |

**业务规则:**
- 同一手机号/Email只能注册一个账户
- 验证码有效期5分钟
- 24小时内最多发送5次验证码

#### 3.1.2 登录

| ID | 需求 | 优先级 |
|----|------|--------|
| U-008 | 手机号+密码登录 | P0 |
| U-009 | Email+密码登录 | P0 |
| U-010 | 手机号+验证码快捷登录 | P1 |
| U-011 | 记住登录状态（30天） | P0 |
| U-012 | 多设备登录支持 | P1 |

#### 3.1.3 密码重置

| ID | 需求 | 优先级 |
|----|------|--------|
| U-013 | 通过手机号验证码重置密码 | P0 |
| U-014 | 通过Email链接重置密码 | P0 |
| U-015 | 重置链接有效期24小时 | P0 |

#### 3.1.4 用户资料

| ID | 需求 | 优先级 |
|----|------|--------|
| U-016 | 头像上传 | P1 |
| U-017 | 昵称设置 | P0 |
| U-018 | 所在地区选择 | P0 |
| U-019 | 联系方式展示设置（隐藏/显示手机号） | P0 |
| U-020 | 账户注销 | P1 |

---

### 3.2 车牌号查询 (Plate Lookup)

**功能描述:** 用户输入车牌号，系统自动获取并展示车辆官方信息

#### 3.2.1 查询功能

| ID | 需求 | 优先级 |
|----|------|--------|
| P-001 | 输入车牌号进行查询 | P0 |
| P-002 | 支持标准NZ车牌格式校验 | P0 |
| P-003 | 查询结果缓存（24小时） | P1 |
| P-004 | 未登录用户每日限制3次查询 | P0 |
| P-005 | 登录用户每日限制10次查询 | P0 |

#### 3.2.2 展示信息

| ID | 信息项 | 数据来源 | 优先级 |
|----|--------|----------|--------|
| P-006 | 品牌/车型/年份 | NZTA | P0 |
| P-007 | WOF状态及到期日 | NZTA | P0 |
| P-008 | Rego状态及到期日 | NZTA | P0 |
| P-009 | 里程数记录 | NZTA | P0 |
| P-010 | 首次注册日期 | NZTA | P0 |
| P-011 | 发动机排量/燃油类型 | NZTA | P1 |
| P-012 | 车身类型/颜色 | NZTA | P1 |
| P-013 | 被盗记录检查 | 第三方 | P2 |
| P-014 | 财务抵押状态 | PPSR | P2 |

---

### 3.3 简易卖车发布 (Quick Listing)

**功能描述:** 卖家通过简化流程快速发布车辆信息

#### 3.3.1 发布流程

**Step 1: 输入车牌号**

| ID | 需求 | 优先级 |
|----|------|--------|
| L-001 | 输入车牌号自动获取车辆基本信息 | P0 |
| L-002 | 展示获取到的信息供用户确认 | P0 |
| L-003 | 允许用户修正自动获取的信息 | P0 |
| L-004 | 手动输入车辆信息（车牌查询失败时） | P1 |

**Step 2: 上传图片**

| ID | 需求 | 优先级 |
|----|------|--------|
| L-005 | 支持最多10张图片上传 | P0 |
| L-006 | 支持拖拽上传 | P1 |
| L-007 | 支持手机相册选择/直接拍照 | P0 |
| L-008 | 图片压缩处理（最大2MB/张） | P0 |
| L-009 | 图片顺序调整 | P1 |
| L-010 | 第一张图片作为封面 | P0 |
| L-011 | 最少上传3张图片 | P0 |
| L-012 | 推荐拍摄角度提示 | P2 |

**Step 3: AI生成描述**

| ID | 需求 | 优先级 |
|----|------|--------|
| L-013 | 基于车辆信息+图片AI生成描述 | P0 |
| L-014 | 描述包含亮点、车况、适用场景 | P0 |
| L-015 | 用户可编辑AI生成的描述 | P0 |
| L-016 | 重新生成描述功能 | P1 |
| L-017 | 支持中英文描述生成 | P1 |

**Step 4: 填写价格**

| ID | 需求 | 优先级 |
|----|------|--------|
| L-018 | 手动输入期望价格 | P0 |
| L-019 | 展示AI建议价格范围 | P0 |
| L-020 | 价格与市场对比提示 | P1 |
| L-021 | 支持"价格面议"选项 | P1 |

**Step 5: 提交发布**

| ID | 需求 | 优先级 |
|----|------|--------|
| L-022 | 预览发布效果 | P0 |
| L-023 | 确认提交 | P0 |
| L-024 | 发布成功提示及分享 | P0 |
| L-025 | 草稿保存功能 | P1 |

---

### 3.4 AI车况分析 + AI定价 (AI Analysis & Pricing)

#### 3.4.1 AI车况分析

| ID | 需求 | 优先级 |
|----|------|--------|
| A-001 | 基于图片识别车辆外观状况 | P1 |
| A-002 | 识别明显损伤/划痕/凹陷 | P1 |
| A-003 | 内饰状况评估 | P2 |
| A-004 | 生成车况评分（1-10分） | P1 |
| A-005 | 生成车况描述文本 | P0 |

#### 3.4.2 AI智能定价

| ID | 需求 | 优先级 |
|----|------|--------|
| A-006 | 基于车型/年份/里程计算基础价格 | P0 |
| A-007 | 参考同类车源市场价格 | P0 |
| A-008 | 给出建议价格范围（最低-推荐-最高） | P0 |
| A-009 | 展示定价依据说明 | P1 |
| A-010 | 价格趋势分析（上涨/下跌/稳定） | P2 |

**定价算法参考因素:**
- 车辆品牌/车型/年份
- 里程数
- WOF/Rego状态
- 市场同类车源价格分布
- 季节性因素
- 所在地区

---

### 3.5 降价提醒 (Price Alert)

| ID | 需求 | 优先级 |
|----|------|--------|
| PA-001 | 用户收藏车源时可选择开启降价提醒 | P0 |
| PA-002 | 卖家修改价格时触发提醒 | P0 |
| PA-003 | 通过Email发送降价通知 | P0 |
| PA-004 | 通过站内消息通知 | P1 |
| PA-005 | 通过Push通知（App） | P2 |
| PA-006 | 支持设置期望价格，低于该价格时通知 | P1 |
| PA-007 | 提醒邮件包含车辆信息和降价幅度 | P0 |
| PA-008 | 取消降价提醒功能 | P0 |

**邮件模板要素:**
- 车辆标题和图片
- 原价格
- 新价格
- 降价幅度（金额和百分比）
- 一键查看按钮
- 取消订阅链接

---

### 3.6 车源列表与搜索 (Listing & Search)

#### 3.6.1 车源列表

| ID | 需求 | 优先级 |
|----|------|--------|
| S-001 | 分页展示车源列表（每页20条） | P0 |
| S-002 | 列表项包含：封面图、标题、价格、年份、里程、地区 | P0 |
| S-003 | 支持列表/网格视图切换 | P2 |
| S-004 | 下拉刷新获取最新数据 | P0 |
| S-005 | 无限滚动加载更多 | P0 |

#### 3.6.2 搜索与筛选

| ID | 需求 | 优先级 |
|----|------|--------|
| S-006 | 关键词搜索（车型、品牌） | P0 |
| S-007 | 品牌筛选（多选） | P0 |
| S-008 | 车型筛选 | P0 |
| S-009 | 价格范围筛选 | P0 |
| S-010 | 年份范围筛选 | P0 |
| S-011 | 里程范围筛选 | P0 |
| S-012 | 地区筛选（Region） | P0 |
| S-013 | 燃油类型筛选（Petrol/Diesel/Hybrid/Electric） | P1 |
| S-014 | 变速箱类型筛选（Auto/Manual） | P1 |
| S-015 | 车身类型筛选（Sedan/SUV/Hatchback等） | P1 |

#### 3.6.3 排序

| ID | 需求 | 优先级 |
|----|------|--------|
| S-016 | 默认排序（综合推荐） | P0 |
| S-017 | 价格从低到高 | P0 |
| S-018 | 价格从高到低 | P0 |
| S-019 | 发布时间最新 | P0 |
| S-020 | 里程从低到高 | P1 |

#### 3.6.4 收藏夹

| ID | 需求 | 优先级 |
|----|------|--------|
| S-021 | 一键收藏/取消收藏车源 | P0 |
| S-022 | 收藏夹列表查看 | P0 |
| S-023 | 收藏夹显示价格变化 | P1 |
| S-024 | 收藏车辆下架提醒 | P2 |

---

### 3.7 车源详情页 (Listing Detail)

| ID | 需求 | 优先级 |
|----|------|--------|
| D-001 | 图片轮播展示 | P0 |
| D-002 | 图片全屏查看 | P0 |
| D-003 | 车辆基本信息展示 | P0 |
| D-004 | 卖家描述展示 | P0 |
| D-005 | AI车况分析报告 | P1 |
| D-006 | 车牌查询信息展示（脱敏） | P1 |
| D-007 | 价格及AI估价对比 | P1 |
| D-008 | 卖家信息展示 | P0 |
| D-009 | 联系卖家按钮 | P0 |
| D-010 | 收藏按钮 | P0 |
| D-011 | 分享功能 | P1 |
| D-012 | 举报功能 | P1 |
| D-013 | 相似车源推荐 | P2 |

---

### 3.8 消息系统 (Messaging)

| ID | 需求 | 优先级 |
|----|------|--------|
| M-001 | 买卖双方站内即时通讯 | P1 |
| M-002 | 消息列表展示 | P1 |
| M-003 | 未读消息数量提示 | P1 |
| M-004 | 新消息邮件通知 | P1 |
| M-005 | 消息关联具体车源 | P1 |
| M-006 | 支持发送图片 | P2 |

---

### 3.9 卖家后台 (Seller Dashboard)

| ID | 需求 | 优先级 |
|----|------|--------|
| SD-001 | 我的车源列表 | P0 |
| SD-002 | 车源状态管理（在售/已售/下架） | P0 |
| SD-003 | 编辑已发布车源 | P0 |
| SD-004 | 删除车源 | P0 |
| SD-005 | 修改价格（触发降价提醒） | P0 |
| SD-006 | 车源浏览量统计 | P1 |
| SD-007 | 收藏量统计 | P1 |
| SD-008 | 刷新车源（提升排名） | P2 |

---

### 3.10 车源数据爬取 (Data Crawling)

| ID | 需求 | 优先级 |
|----|------|--------|
| C-001 | 爬取TradeMe二手车数据 | P1 |
| C-002 | 爬取Facebook Marketplace车源 | P2 |
| C-003 | 数据去重处理 | P1 |
| C-004 | 定时增量更新 | P1 |
| C-005 | 价格变动追踪 | P1 |
| C-006 | 标注数据来源 | P1 |

**爬取字段:**
- 标题
- 价格
- 图片URL
- 车辆信息（品牌/车型/年份/里程）
- 地区
- 发布时间
- 卖家类型（个人/车行）
- 原始链接

---

## 4. 用户故事

### 4.1 买家故事

```
US-B001: 作为一个买家，我想要搜索特定品牌和价格范围的二手车，以便找到符合我预算的车辆。

US-B002: 作为一个买家，我想要通过车牌号查询车辆历史，以便确认车辆没有事故记录。

US-B003: 作为一个买家，我想要收藏感兴趣的车辆并收到降价提醒，以便在合适的价格购买。

US-B004: 作为一个买家，我想要查看AI估价与卖家报价的对比，以便判断价格是否合理。

US-B005: 作为一个买家，我想要直接联系卖家，以便预约看车时间。

US-B006: 作为一个新移民买家，我想要看到中英文车况描述，以便更好地理解车辆状况。
```

### 4.2 卖家故事

```
US-S001: 作为一个卖家，我想要通过输入车牌号自动获取车辆信息，以便节省填写时间。

US-S002: 作为一个卖家，我想要上传照片后获得AI生成的车况描述，以便专业地展示我的车辆。

US-S003: 作为一个卖家，我想要获得AI定价建议，以便设定一个合理的市场价格。

US-S004: 作为一个卖家，我想要管理我发布的车源状态，以便在车辆售出后及时更新。

US-S005: 作为一个卖家，我想要查看我车源的浏览量和收藏量，以便了解市场反馈。

US-S006: 作为一个卖家，我想要30秒内完成车辆发布，以便快速开始销售。
```

---

## 5. 信息架构

```
KiwiCar
├── 首页 (Landing Page)
├── 买车
│   ├── 车源列表
│   │   ├── 搜索
│   │   └── 筛选
│   ├── 车源详情
│   └── 收藏夹
├── 卖车
│   ├── 发布车辆
│   │   ├── 输入车牌
│   │   ├── 上传图片
│   │   ├── AI生成描述
│   │   ├── 设定价格
│   │   └── 预览发布
│   └── 我的车源
│       ├── 编辑车源
│       └── 管理状态
├── 车牌查询
│   └── 查询结果
├── 消息中心
│   └── 聊天详情
├── 个人中心
│   ├── 我的资料
│   ├── 账户设置
│   ├── 通知设置
│   └── 帮助中心
└── 用户认证
    ├── 注册
    ├── 登录
    └── 重置密码
```

---

## 6. 功能优先级

### P0 - MVP必备 (第一阶段)

| 模块 | 功能 |
|------|------|
| 用户系统 | 注册、登录、密码重置 |
| 车牌查询 | 基本车辆信息查询 |
| 卖车发布 | 完整发布流程 |
| AI功能 | AI描述生成、AI定价建议 |
| 车源浏览 | 列表、搜索、筛选、详情 |
| 收藏 | 收藏车源 |
| 降价提醒 | 邮件通知 |

### P1 - 增强功能 (第二阶段)

| 模块 | 功能 |
|------|------|
| 用户系统 | 社交登录、资料完善 |
| 车牌查询 | 更多车辆信息、查询历史 |
| AI功能 | 图片车况分析、定价解释 |
| 消息系统 | 站内即时通讯 |
| 数据爬取 | TradeMe数据整合 |
| 卖家后台 | 数据统计 |

### P2 - 未来规划 (第三阶段)

| 模块 | 功能 |
|------|------|
| 用户系统 | Apple ID登录 |
| 车牌查询 | 被盗/抵押检查 |
| AI功能 | 内饰分析、趋势预测 |
| 消息系统 | 图片发送、Push通知 |
| 数据爬取 | Facebook Marketplace整合 |
| 增值服务 | 付费推广、认证卖家 |

---

## 7. 技术栈

### 7.1 前端技术

| 技术 | 版本/说明 | 用途 |
|------|----------|------|
| React.js | 18+ | 前端框架 |
| TypeScript | 5.0+ | 类型安全 |
| Vite | 5.0+ | 构建工具 |
| React Router | 6+ | 路由管理 |
| Tailwind CSS | 3.0+ | 样式框架 |
| Zustand | - | 状态管理 |
| React Query | - | 服务端状态管理 |
| React Hook Form | - | 表单处理 |
| Zod | - | 数据验证 |
| Axios | - | HTTP 客户端 |

### 7.2 后端技术

| 技术 | 版本/说明 | 用途 |
|------|----------|------|
| Node.js | 20 LTS | 运行时环境 |
| Express.js | 4.x | Web 框架 |
| TypeScript | 5.0+ | 类型安全 |
| Prisma | - | ORM |
| JWT | - | 身份认证 |
| bcrypt | - | 密码加密 |
| Multer | - | 文件上传 |
| Node-cron | - | 定时任务 |
| Winston | - | 日志管理 |

### 7.3 数据库与存储

| 技术 | 用途 |
|------|------|
| MySQL | 8.0+ | 主数据库 |
| Redis | 缓存、会话存储 |
| AWS S3 / Cloudflare R2 | 图片存储 |

### 7.4 开发与部署

| 技术 | 用途 |
|------|------|
| pnpm | 包管理器 |
| ESLint | 代码检查 |
| Prettier | 代码格式化 |
| Vitest | 单元测试 |
| Docker | 容器化 |
| GitHub Actions | CI/CD |

### 7.5 技术架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                         客户端 (Client)                          │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    React.js + TypeScript                 │    │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │    │
│  │  │  Zustand │ │  React   │ │ Tailwind │ │   Zod    │   │    │
│  │  │  (State) │ │  Query   │ │   CSS    │ │(Validate)│   │    │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ HTTPS / REST API
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        服务端 (Server)                           │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                  Node.js + Express.js                    │    │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │    │
│  │  │  Prisma  │ │   JWT    │ │  Multer  │ │ Winston  │   │    │
│  │  │  (ORM)   │ │  (Auth)  │ │ (Upload) │ │  (Log)   │   │    │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                ┌───────────────┼───────────────┐
                ▼               ▼               ▼
        ┌──────────┐    ┌──────────┐    ┌──────────┐
        │  MySQL   │    │  Redis   │    │ S3 / R2  │
        │ (数据库)  │    │  (缓存)  │    │ (存储)   │
        └──────────┘    └──────────┘    └──────────┘
```

---

## 8. 非功能性需求

### 8.1 性能需求

| 指标 | 要求 |
|------|------|
| 页面加载时间 | 首屏 < 2秒 (3G网络) |
| 搜索响应时间 | < 500ms |
| API响应时间 | 95% < 200ms |
| 图片上传速度 | 10张图 < 30秒 |
| 并发用户支持 | 1000+ 同时在线 |

### 8.2 可用性需求

| 指标 | 要求 |
|------|------|
| 系统可用性 | 99.9% uptime |
| 数据备份 | 每日自动备份 |
| 故障恢复时间 | < 4小时 |

### 8.3 安全需求

| 指标 | 要求 |
|------|------|
| 数据传输 | HTTPS加密 |
| 密码存储 | bcrypt哈希 |
| API认证 | JWT Token |
| 敏感信息 | 手机号/邮箱脱敏显示 |
| 防护措施 | SQL注入、XSS、CSRF防护 |
| 隐私合规 | 符合NZ Privacy Act |

### 8.4 兼容性需求

| 平台 | 要求 |
|------|------|
| 浏览器 | Chrome 80+, Safari 13+, Firefox 75+, Edge 80+ |
| 移动端 | iOS 13+, Android 8+ |
| 响应式 | 支持 320px - 1920px 屏幕宽度 |

### 8.5 可扩展性需求

- 支持水平扩展，应对流量增长
- 模块化设计，便于功能迭代
- API版本控制，支持向后兼容

---

## 9. 数据需求

### 9.1 核心数据模型

#### User (用户)
```
- id: UUID
- email: String (unique)
- phone: String (unique, NZ format)
- password_hash: String
- nickname: String
- avatar_url: String
- region: String
- is_verified: Boolean
- created_at: DateTime
- updated_at: DateTime
```

#### Listing (车源)
```
- id: UUID
- user_id: UUID (FK)
- plate_number: String
- make: String (品牌)
- model: String (车型)
- year: Integer
- mileage: Integer (km)
- price: Decimal
- description: String
- ai_description: String
- ai_price_min: Decimal
- ai_price_max: Decimal
- status: Enum (active, sold, removed)
- region: String
- fuel_type: Enum
- transmission: Enum
- body_type: String
- color: String
- created_at: DateTime
- updated_at: DateTime
```

#### ListingImage (车源图片)
```
- id: UUID
- listing_id: UUID (FK)
- image_url: String
- order: Integer
- created_at: DateTime
```

#### Favorite (收藏)
```
- id: UUID
- user_id: UUID (FK)
- listing_id: UUID (FK)
- price_alert: Boolean
- target_price: Decimal
- created_at: DateTime
```

#### PriceHistory (价格历史)
```
- id: UUID
- listing_id: UUID (FK)
- price: Decimal
- changed_at: DateTime
```

#### Message (消息)
```
- id: UUID
- sender_id: UUID (FK)
- receiver_id: UUID (FK)
- listing_id: UUID (FK)
- content: String
- is_read: Boolean
- created_at: DateTime
```

#### VehicleInfo (车辆信息缓存)
```
- plate_number: String (PK)
- make: String
- model: String
- year: Integer
- wof_expiry: Date
- rego_expiry: Date
- odometer_readings: JSON
- first_registered: Date
- engine_cc: Integer
- fuel_type: String
- body_style: String
- color: String
- fetched_at: DateTime
```

### 9.2 数据存储需求

| 数据类型 | 存储方案 |
|----------|----------|
| 结构化数据 | MySQL 8.0+ |
| 图片文件 | AWS S3 / Cloudflare R2 |
| 缓存数据 | Redis |
| 搜索索引 | Elasticsearch / Meilisearch |

### 9.3 数据保留策略

| 数据类型 | 保留期限 |
|----------|----------|
| 用户账户数据 | 永久（账户存续期） |
| 活跃车源 | 永久 |
| 已完成/删除车源 | 1年 |
| 消息记录 | 2年 |
| 操作日志 | 90天 |
| 车辆信息缓存 | 24小时 |

---

## 10. 第三方集成

### 10.1 必需集成

| 服务 | 用途 | 优先级 |
|------|------|--------|
| NZTA Vehicles API | 车辆信息查询 | P0 |
| SendGrid / Mailgun | 邮件发送 | P0 |
| Twilio / AWS SNS | 短信验证码 | P0 |
| AWS S3 / Cloudflare R2 | 图片存储 | P0 |
| OpenAI GPT-4 | AI描述生成、定价分析 | P0 |
| Google Cloud Vision | 图片内容识别 | P1 |

### 10.2 可选集成

| 服务 | 用途 | 优先级 |
|------|------|--------|
| Google OAuth | 社交登录 | P1 |
| Facebook OAuth | 社交登录 | P1 |
| Apple Sign In | 社交登录 | P2 |
| PPSR | 财务抵押查询 | P2 |
| Google Analytics | 数据分析 | P1 |
| Sentry | 错误监控 | P1 |

### 10.3 NZTA API 集成说明

**数据来源:** NZTA Motor Vehicle Register

**可获取信息:**
- 车辆基本信息（Make, Model, Year, Body Type）
- WOF状态和到期日
- Registration状态和到期日
- 里程表读数历史
- 首次注册日期
- 发动机信息

**调用限制:**
- 需申请API访问权限
- 遵守数据使用条款
- 注意调用频率限制

---

## 11. 风险与约束

### 11.1 技术风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| NZTA API不稳定 | 车牌查询功能失效 | 实现缓存机制，降级方案 |
| AI生成内容不准确 | 用户体验下降 | 允许用户编辑，持续优化模型 |
| 爬虫被封禁 | 数据来源受限 | 合规爬取，多数据源备份 |
| 图片存储成本 | 运营成本上升 | 图片压缩，定期清理 |

### 11.2 业务风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 竞品模仿 | 市场份额流失 | 快速迭代，建立品牌壁垒 |
| 用户增长缓慢 | 商业模式难以为继 | SEO优化，社交营销 |
| 虚假信息泛滥 | 平台信誉受损 | 举报机制，人工审核 |

### 11.3 法律合规

| 要求 | 说明 |
|------|------|
| Privacy Act 2020 | 用户数据收集、存储、使用需符合NZ隐私法 |
| 消费者保护法 | 确保平台信息真实，不误导消费者 |
| 版权法 | 爬取数据需注意版权问题 |
| 反洗钱法规 | 大额交易可能触发AML合规要求 |

---

## 12. 成功指标

### 12.1 北极星指标

**月活跃用户数 (MAU)** - 衡量平台整体健康度

### 12.2 核心指标

| 类别 | 指标 | 目标 (6个月) |
|------|------|-------------|
| 增长 | 注册用户数 | 10,000 |
| 增长 | 月活跃用户 | 3,000 |
| 供给 | 活跃车源数 | 5,000 |
| 转化 | 车源发布转化率 | 60% |
| 参与 | 用户平均收藏数 | 5 |
| 参与 | 日均车牌查询次数 | 500 |
| 交易 | 月成交车辆数 | 200 |
| 留存 | 次月留存率 | 30% |

### 12.3 质量指标

| 指标 | 目标 |
|------|------|
| 页面加载成功率 | > 99.5% |
| AI描述采纳率 | > 80% |
| AI定价偏差 | < 10% |
| 用户举报率 | < 1% |
| 邮件送达率 | > 95% |

---

## 13. 附录

### 13.1 术语表

| 术语 | 定义 |
|------|------|
| WOF | Warrant of Fitness，新西兰车辆年检证书 |
| Rego | Vehicle Registration，车辆注册 |
| NZTA | New Zealand Transport Agency，新西兰交通局 |
| PPSR | Personal Property Securities Register，动产抵押登记 |
| MAU | Monthly Active Users，月活跃用户 |

### 13.2 参考资料

- NZTA Vehicle Register API文档
- 新西兰Privacy Act 2020
- TradeMe二手车市场分析
- 新西兰二手车交易行业报告

### 13.3 版本历史

| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| 1.0 | 2024-01 | 初始版本 | - |

---

*文档结束*